<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.2.0 (458672)"/><meta name="author" content="林"/><meta name="created" content="2019-10-08 07:26:21 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-10-11 07:33:23 +0000"/><meta name="content-class" content="yinxiang.markdown"/><title>View的工作原理</title></head><body><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><div style="line-height: 160%; box-sizing: content-box;"><ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;"><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">ViewRoot
</a></li><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">MeasureSpec
</a></li><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">View的工作流程
</a><ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;"><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">view——measure
</a></li><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">viewGroup——measure
</a></li><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">LinearLayout--onMeasure()
</a></li></ul></li><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">layout
</a></li><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">draw
</a></li></ul></div><h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">ViewRoot</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">ViewRoot对应于ViewRootImpl类，是WindowManager与DecorView的纽带。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">当Activity创建完毕后，会将DecorView添加到Window中，同时创建ViewRootImpl对象，与DecorView建立关联。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">View的绘制从ViewRoot的performTraversals()开始，依次调用performMeasure(),perfromLayout,performDraw()方法，其中performMeasure()方法依次调用了decorview的draw()和onDraw()方法。在onDraw()方法中会遍历所有子类view，这时measure就从基类转移到子类去了，子类view又重复基类view的调用过程，如此反复就完成了整个view树的遍历。</p>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">MeasureSpec</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">View的LayoutParams根据父容器施加的规则转换成对应的MeasureSpec,View在根据MeasureSpec来测量出对应的宽高。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">MeasureSpec 是一个32位的Int,高2位代表MeasureMode,低两位代表MeasureSize。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">MeasureMode</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">UNSPECIFIED</strong>:未指定，父容器不对view有任何限制</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">EXACTLY</strong>:精确模式，父容器已经测定出了View的精确大小，即测量值</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">AT_MOST</strong>:最大模式，父容器指定了一个最大值，子view不能超过它</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">对于DecorView，MeasureSpec由窗口的尺寸和自身的LayoutParams决定，对于普通view，MeasureSpec由父容器的MeasureSpec和自身的LayoutParams共同决定。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">绘制流程：</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">ViewRootImpl<br/>
-&gt;performTraversals()<br/>
-&gt;measureHierarchy()根据窗口和LayoutParams测出顶级View的MeasureSpec<br/>
-&gt;measureChildWithMargins()<br/>
根据父容器MeasureSpec，自己的LayoutParams,父亲的padding和自己的margin测出自身的MeasureSpec</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">measureChildWithMargins()-&gt;getChildMeasureSpec():</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">childDimension:由子类自身的LayoutParams决定的view大小<br/>
size：父容器剩余可用的大小，最小为0<br/>
specMode:父容器spec模式</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">when(specMode):
EXACTLY-&gt;
    MATCH_PARAMS-&gt;
        resultSize = size
        resultMode = EXACTLY
    WRAP_CONTENT-&gt;
        resultSize = size
        resultMode = AT_MOST
    固定大小-&gt;
        resultSize = childDimension
        resultMode = EXACTLY
AT_MOST-&gt;
    MATCH_PARAMS-&gt;
        resultSize = size
        resultMode = AT_MOST
    WRAP_CONTENT-&gt;
        resultSize = size
        resultMode = AT_MOST
    固定大小-&gt;
        resultSize = childDimension
        resultMode = EXACTLY
UNSPECIFIED-&gt;
    MATCH_PARAMS-&gt;
        resultSize = 0
        resultMode = UNSPECIFIED
    WRAP_CONTENT-&gt;
        resultSize = 0
        resultMode = UNSPECIFIED
    固定大小-&gt;
        resultSize = childDimension
        resultMode = EXACTLY
</code></pre>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">View的工作流程</h2>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">view——measure</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">view的measure由measure方法完成，measure是final，无法重写，它会调用onMeasure</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">根据源码在UNSPECIFIED下，view的测量大小是minWidth,和背景的minWidth决定</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">在测量值是AT_MOST和EXACTLY下size = measureSize</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">并且根据之前子view onMeasure()源码，如果子view直接使用wrap_content,那么它的specMode就是AT_MOST，specSize等于父容器的剩余空间，也就和MATCH_PARAMS相同的</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">所以以view为基类重写view时都要重写onMeasure，并设置AT_MOST的情况</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">viewGroup——measure</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">viewGroup是一个抽象类，它并没有实现view的onMeasure方法，因为每个viewGroup通常都有不同的布局特性，不能像view一样对它统一实现</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">它提供类一个measureChildren()方法，<br/>
它会对所有的child进行遍历，获取子类的spec，并且进行measure</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">LinearLayout--onMeasure()</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">它对于竖直模式和水平模式进行单独设置</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">LinearLayout##onMeasure()
        if (mOrientation == VERTICAL) {
            measureVertical(widthMeasureSpec, heightMeasureSpec);
        } else {
            measureHorizontal(widthMeasureSpec, heightMeasureSpec);
        }
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">根据竖直的源码，它会对所有子类view进行便利，通过totalLenth存储所有view的高度与margin的和，最后再加上自己的padding，单无论match_params还是wrap_content，都不能超过父容器剩余空间<br/>
而宽度就是普通view过程一样，wrap时是所有view所占宽度最大值(包括margin)</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">onMeasure后就可获取到view到测量值，但是某些情况下会多次measure，这是onMeasure获取到的就可能不准确，所以可以在onLayout后获取测量值</p>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">layout</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">layout方法是确定viewgroup本身的位置，而onLayout方法是确定所有子类的位置<br/>
layout方法首先会调用setFram()确认自己四个顶点的位置，然后在调用onLayout()</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">和measure一样，不同的viewGroup有不同的onLayout方法<br/>
如linearlayout，它会先遍历view并获取view到specSize，并计算出view到left和top，之后在调用setChildFrame()来调用子类的onLayout方法。</p>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">draw</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">draw作用是将view绘制在屏幕上<br/>
会依次调用：<br/>
drawBackground(canvas)绘制背景<br/>
onDraw(canvas)绘制自身<br/>
dispatchDraw(canvas)绘制子类，它会遍历调用所有子类的draw<br/>
onDrawSrollBars(canvas)绘制装束？</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">setWillNotDraw(boolean)<br/>
当我们自定义view继承于viewgroup并且不需要具备绘制功能时，可以设置它以便系统后续优化</p>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%5BTOC%5D%0A%23%23%20ViewRoot%0A%20%20%20ViewRoot%E5%AF%B9%E5%BA%94%E4%BA%8EViewRootImpl%E7%B1%BB%EF%BC%8C%E6%98%AFWindowManager%E4%B8%8EDecorView%E7%9A%84%E7%BA%BD%E5%B8%A6%E3%80%82%0A%20%20%20%0A%20%20%20%E5%BD%93Activity%E5%88%9B%E5%BB%BA%E5%AE%8C%E6%AF%95%E5%90%8E%EF%BC%8C%E4%BC%9A%E5%B0%86DecorView%E6%B7%BB%E5%8A%A0%E5%88%B0Window%E4%B8%AD%EF%BC%8C%E5%90%8C%E6%97%B6%E5%88%9B%E5%BB%BAViewRootImpl%E5%AF%B9%E8%B1%A1%EF%BC%8C%E4%B8%8EDecorView%E5%BB%BA%E7%AB%8B%E5%85%B3%E8%81%94%E3%80%82%0A%20%20%20%0A%20%20%20View%E7%9A%84%E7%BB%98%E5%88%B6%E4%BB%8EViewRoot%E7%9A%84performTraversals()%E5%BC%80%E5%A7%8B%EF%BC%8C%E4%BE%9D%E6%AC%A1%E8%B0%83%E7%94%A8performMeasure()%2CperfromLayout%2CperformDraw()%E6%96%B9%E6%B3%95%EF%BC%8C%E5%85%B6%E4%B8%ADperformMeasure()%E6%96%B9%E6%B3%95%E4%BE%9D%E6%AC%A1%E8%B0%83%E7%94%A8%E4%BA%86decorview%E7%9A%84draw()%E5%92%8ConDraw()%E6%96%B9%E6%B3%95%E3%80%82%E5%9C%A8onDraw()%E6%96%B9%E6%B3%95%E4%B8%AD%E4%BC%9A%E9%81%8D%E5%8E%86%E6%89%80%E6%9C%89%E5%AD%90%E7%B1%BBview%EF%BC%8C%E8%BF%99%E6%97%B6measure%E5%B0%B1%E4%BB%8E%E5%9F%BA%E7%B1%BB%E8%BD%AC%E7%A7%BB%E5%88%B0%E5%AD%90%E7%B1%BB%E5%8E%BB%E4%BA%86%EF%BC%8C%E5%AD%90%E7%B1%BBview%E5%8F%88%E9%87%8D%E5%A4%8D%E5%9F%BA%E7%B1%BBview%E7%9A%84%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%EF%BC%8C%E5%A6%82%E6%AD%A4%E5%8F%8D%E5%A4%8D%E5%B0%B1%E5%AE%8C%E6%88%90%E4%BA%86%E6%95%B4%E4%B8%AAview%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86%E3%80%82%0A%20%20%20%0A%23%23%20MeasureSpec%0AView%E7%9A%84LayoutParams%E6%A0%B9%E6%8D%AE%E7%88%B6%E5%AE%B9%E5%99%A8%E6%96%BD%E5%8A%A0%E7%9A%84%E8%A7%84%E5%88%99%E8%BD%AC%E6%8D%A2%E6%88%90%E5%AF%B9%E5%BA%94%E7%9A%84MeasureSpec%2CView%E5%9C%A8%E6%A0%B9%E6%8D%AEMeasureSpec%E6%9D%A5%E6%B5%8B%E9%87%8F%E5%87%BA%E5%AF%B9%E5%BA%94%E7%9A%84%E5%AE%BD%E9%AB%98%E3%80%82%0A%0AMeasureSpec%20%E6%98%AF%E4%B8%80%E4%B8%AA32%E4%BD%8D%E7%9A%84Int%2C%E9%AB%982%E4%BD%8D%E4%BB%A3%E8%A1%A8MeasureMode%2C%E4%BD%8E%E4%B8%A4%E4%BD%8D%E4%BB%A3%E8%A1%A8MeasureSize%E3%80%82%0A%0AMeasureMode%0A*%20**UNSPECIFIED**%3A%E6%9C%AA%E6%8C%87%E5%AE%9A%EF%BC%8C%E7%88%B6%E5%AE%B9%E5%99%A8%E4%B8%8D%E5%AF%B9view%E6%9C%89%E4%BB%BB%E4%BD%95%E9%99%90%E5%88%B6%0A*%20**EXACTLY**%3A%E7%B2%BE%E7%A1%AE%E6%A8%A1%E5%BC%8F%EF%BC%8C%E7%88%B6%E5%AE%B9%E5%99%A8%E5%B7%B2%E7%BB%8F%E6%B5%8B%E5%AE%9A%E5%87%BA%E4%BA%86View%E7%9A%84%E7%B2%BE%E7%A1%AE%E5%A4%A7%E5%B0%8F%EF%BC%8C%E5%8D%B3%E6%B5%8B%E9%87%8F%E5%80%BC%0A*%20**AT_MOST**%3A%E6%9C%80%E5%A4%A7%E6%A8%A1%E5%BC%8F%EF%BC%8C%E7%88%B6%E5%AE%B9%E5%99%A8%E6%8C%87%E5%AE%9A%E4%BA%86%E4%B8%80%E4%B8%AA%E6%9C%80%E5%A4%A7%E5%80%BC%EF%BC%8C%E5%AD%90view%E4%B8%8D%E8%83%BD%E8%B6%85%E8%BF%87%E5%AE%83%0A%0A%0A%E5%AF%B9%E4%BA%8EDecorView%EF%BC%8CMeasureSpec%E7%94%B1%E7%AA%97%E5%8F%A3%E7%9A%84%E5%B0%BA%E5%AF%B8%E5%92%8C%E8%87%AA%E8%BA%AB%E7%9A%84LayoutParams%E5%86%B3%E5%AE%9A%EF%BC%8C%E5%AF%B9%E4%BA%8E%E6%99%AE%E9%80%9Aview%EF%BC%8CMeasureSpec%E7%94%B1%E7%88%B6%E5%AE%B9%E5%99%A8%E7%9A%84MeasureSpec%E5%92%8C%E8%87%AA%E8%BA%AB%E7%9A%84LayoutParams%E5%85%B1%E5%90%8C%E5%86%B3%E5%AE%9A%E3%80%82%0A%0A%0A%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B%EF%BC%9A%0A%0AViewRootImpl%0A-%3EperformTraversals()%0A-%3EmeasureHierarchy()%E6%A0%B9%E6%8D%AE%E7%AA%97%E5%8F%A3%E5%92%8CLayoutParams%E6%B5%8B%E5%87%BA%E9%A1%B6%E7%BA%A7View%E7%9A%84MeasureSpec%0A-%3EmeasureChildWithMargins()%0A%E6%A0%B9%E6%8D%AE%E7%88%B6%E5%AE%B9%E5%99%A8MeasureSpec%EF%BC%8C%E8%87%AA%E5%B7%B1%E7%9A%84LayoutParams%2C%E7%88%B6%E4%BA%B2%E7%9A%84padding%E5%92%8C%E8%87%AA%E5%B7%B1%E7%9A%84margin%E6%B5%8B%E5%87%BA%E8%87%AA%E8%BA%AB%E7%9A%84MeasureSpec%0A%0AmeasureChildWithMargins()-%3EgetChildMeasureSpec()%3A%0A%0AchildDimension%3A%E7%94%B1%E5%AD%90%E7%B1%BB%E8%87%AA%E8%BA%AB%E7%9A%84LayoutParams%E5%86%B3%E5%AE%9A%E7%9A%84view%E5%A4%A7%E5%B0%8F%0Asize%EF%BC%9A%E7%88%B6%E5%AE%B9%E5%99%A8%E5%89%A9%E4%BD%99%E5%8F%AF%E7%94%A8%E7%9A%84%E5%A4%A7%E5%B0%8F%EF%BC%8C%E6%9C%80%E5%B0%8F%E4%B8%BA0%0AspecMode%3A%E7%88%B6%E5%AE%B9%E5%99%A8spec%E6%A8%A1%E5%BC%8F%0A%0A%60%60%60%0Awhen(specMode)%3A%0AEXACTLY-%3E%0A%20%20%20%20MATCH_PARAMS-%3E%0A%20%20%20%20%20%20%20%20resultSize%20%3D%20size%0A%20%20%20%20%20%20%20%20resultMode%20%3D%20EXACTLY%0A%20%20%20%20WRAP_CONTENT-%3E%0A%20%20%20%20%20%20%20%20resultSize%20%3D%20size%0A%20%20%20%20%20%20%20%20resultMode%20%3D%20AT_MOST%0A%20%20%20%20%E5%9B%BA%E5%AE%9A%E5%A4%A7%E5%B0%8F-%3E%0A%20%20%20%20%20%20%20%20resultSize%20%3D%20childDimension%0A%20%20%20%20%20%20%20%20resultMode%20%3D%20EXACTLY%0AAT_MOST-%3E%0A%20%20%20%20MATCH_PARAMS-%3E%0A%20%20%20%20%20%20%20%20resultSize%20%3D%20size%0A%20%20%20%20%20%20%20%20resultMode%20%3D%20AT_MOST%0A%20%20%20%20WRAP_CONTENT-%3E%0A%20%20%20%20%20%20%20%20resultSize%20%3D%20size%0A%20%20%20%20%20%20%20%20resultMode%20%3D%20AT_MOST%0A%20%20%20%20%E5%9B%BA%E5%AE%9A%E5%A4%A7%E5%B0%8F-%3E%0A%20%20%20%20%20%20%20%20resultSize%20%3D%20childDimension%0A%20%20%20%20%20%20%20%20resultMode%20%3D%20EXACTLY%0AUNSPECIFIED-%3E%0A%20%20%20%20MATCH_PARAMS-%3E%0A%20%20%20%20%20%20%20%20resultSize%20%3D%200%0A%20%20%20%20%20%20%20%20resultMode%20%3D%20UNSPECIFIED%0A%20%20%20%20WRAP_CONTENT-%3E%0A%20%20%20%20%20%20%20%20resultSize%20%3D%200%0A%20%20%20%20%20%20%20%20resultMode%20%3D%20UNSPECIFIED%0A%20%20%20%20%E5%9B%BA%E5%AE%9A%E5%A4%A7%E5%B0%8F-%3E%0A%20%20%20%20%20%20%20%20resultSize%20%3D%20childDimension%0A%20%20%20%20%20%20%20%20resultMode%20%3D%20EXACTLY%0A%60%60%60%0A%0A%23%23%20View%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%0A%0A%23%23%23%20view%E2%80%94%E2%80%94measure%0Aview%E7%9A%84measure%E7%94%B1measure%E6%96%B9%E6%B3%95%E5%AE%8C%E6%88%90%EF%BC%8Cmeasure%E6%98%AFfinal%EF%BC%8C%E6%97%A0%E6%B3%95%E9%87%8D%E5%86%99%EF%BC%8C%E5%AE%83%E4%BC%9A%E8%B0%83%E7%94%A8onMeasure%0A%0A%E6%A0%B9%E6%8D%AE%E6%BA%90%E7%A0%81%E5%9C%A8UNSPECIFIED%E4%B8%8B%EF%BC%8Cview%E7%9A%84%E6%B5%8B%E9%87%8F%E5%A4%A7%E5%B0%8F%E6%98%AFminWidth%2C%E5%92%8C%E8%83%8C%E6%99%AF%E7%9A%84minWidth%E5%86%B3%E5%AE%9A%0A%0A%E5%9C%A8%E6%B5%8B%E9%87%8F%E5%80%BC%E6%98%AFAT_MOST%E5%92%8CEXACTLY%E4%B8%8Bsize%20%3D%20measureSize%0A%0A%E5%B9%B6%E4%B8%94%E6%A0%B9%E6%8D%AE%E4%B9%8B%E5%89%8D%E5%AD%90view%20onMeasure()%E6%BA%90%E7%A0%81%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%AD%90view%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8wrap_content%2C%E9%82%A3%E4%B9%88%E5%AE%83%E7%9A%84specMode%E5%B0%B1%E6%98%AFAT_MOST%EF%BC%8CspecSize%E7%AD%89%E4%BA%8E%E7%88%B6%E5%AE%B9%E5%99%A8%E7%9A%84%E5%89%A9%E4%BD%99%E7%A9%BA%E9%97%B4%EF%BC%8C%E4%B9%9F%E5%B0%B1%E5%92%8CMATCH_PARAMS%E7%9B%B8%E5%90%8C%E7%9A%84%0A%0A%E6%89%80%E4%BB%A5%E4%BB%A5view%E4%B8%BA%E5%9F%BA%E7%B1%BB%E9%87%8D%E5%86%99view%E6%97%B6%E9%83%BD%E8%A6%81%E9%87%8D%E5%86%99onMeasure%EF%BC%8C%E5%B9%B6%E8%AE%BE%E7%BD%AEAT_MOST%E7%9A%84%E6%83%85%E5%86%B5%0A%0A%23%23%23%20viewGroup%E2%80%94%E2%80%94measure%0AviewGroup%E6%98%AF%E4%B8%80%E4%B8%AA%E6%8A%BD%E8%B1%A1%E7%B1%BB%EF%BC%8C%E5%AE%83%E5%B9%B6%E6%B2%A1%E6%9C%89%E5%AE%9E%E7%8E%B0view%E7%9A%84onMeasure%E6%96%B9%E6%B3%95%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%AF%8F%E4%B8%AAviewGroup%E9%80%9A%E5%B8%B8%E9%83%BD%E6%9C%89%E4%B8%8D%E5%90%8C%E7%9A%84%E5%B8%83%E5%B1%80%E7%89%B9%E6%80%A7%EF%BC%8C%E4%B8%8D%E8%83%BD%E5%83%8Fview%E4%B8%80%E6%A0%B7%E5%AF%B9%E5%AE%83%E7%BB%9F%E4%B8%80%E5%AE%9E%E7%8E%B0%0A%0A%E5%AE%83%E6%8F%90%E4%BE%9B%E7%B1%BB%E4%B8%80%E4%B8%AAmeasureChildren()%E6%96%B9%E6%B3%95%EF%BC%8C%0A%E5%AE%83%E4%BC%9A%E5%AF%B9%E6%89%80%E6%9C%89%E7%9A%84child%E8%BF%9B%E8%A1%8C%E9%81%8D%E5%8E%86%EF%BC%8C%E8%8E%B7%E5%8F%96%E5%AD%90%E7%B1%BB%E7%9A%84spec%EF%BC%8C%E5%B9%B6%E4%B8%94%E8%BF%9B%E8%A1%8Cmeasure%0A%0A%23%23%23%20%20LinearLayout--onMeasure()%0A%0A%E5%AE%83%E5%AF%B9%E4%BA%8E%E7%AB%96%E7%9B%B4%E6%A8%A1%E5%BC%8F%E5%92%8C%E6%B0%B4%E5%B9%B3%E6%A8%A1%E5%BC%8F%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%8B%AC%E8%AE%BE%E7%BD%AE%0A%60%60%60%0ALinearLayout%23%23onMeasure()%0A%20%20%20%20%20%20%20%20if%20(mOrientation%20%3D%3D%20VERTICAL)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20measureVertical(widthMeasureSpec%2C%20heightMeasureSpec)%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20measureHorizontal(widthMeasureSpec%2C%20heightMeasureSpec)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%60%60%60%0A%E6%A0%B9%E6%8D%AE%E7%AB%96%E7%9B%B4%E7%9A%84%E6%BA%90%E7%A0%81%EF%BC%8C%E5%AE%83%E4%BC%9A%E5%AF%B9%E6%89%80%E6%9C%89%E5%AD%90%E7%B1%BBview%E8%BF%9B%E8%A1%8C%E4%BE%BF%E5%88%A9%EF%BC%8C%E9%80%9A%E8%BF%87totalLenth%E5%AD%98%E5%82%A8%E6%89%80%E6%9C%89view%E7%9A%84%E9%AB%98%E5%BA%A6%E4%B8%8Emargin%E7%9A%84%E5%92%8C%EF%BC%8C%E6%9C%80%E5%90%8E%E5%86%8D%E5%8A%A0%E4%B8%8A%E8%87%AA%E5%B7%B1%E7%9A%84padding%EF%BC%8C%E5%8D%95%E6%97%A0%E8%AE%BAmatch_params%E8%BF%98%E6%98%AFwrap_content%EF%BC%8C%E9%83%BD%E4%B8%8D%E8%83%BD%E8%B6%85%E8%BF%87%E7%88%B6%E5%AE%B9%E5%99%A8%E5%89%A9%E4%BD%99%E7%A9%BA%E9%97%B4%0A%E8%80%8C%E5%AE%BD%E5%BA%A6%E5%B0%B1%E6%98%AF%E6%99%AE%E9%80%9Aview%E8%BF%87%E7%A8%8B%E4%B8%80%E6%A0%B7%EF%BC%8Cwrap%E6%97%B6%E6%98%AF%E6%89%80%E6%9C%89view%E6%89%80%E5%8D%A0%E5%AE%BD%E5%BA%A6%E6%9C%80%E5%A4%A7%E5%80%BC(%E5%8C%85%E6%8B%ACmargin)%0A%0AonMeasure%E5%90%8E%E5%B0%B1%E5%8F%AF%E8%8E%B7%E5%8F%96%E5%88%B0view%E5%88%B0%E6%B5%8B%E9%87%8F%E5%80%BC%EF%BC%8C%E4%BD%86%E6%98%AF%E6%9F%90%E4%BA%9B%E6%83%85%E5%86%B5%E4%B8%8B%E4%BC%9A%E5%A4%9A%E6%AC%A1measure%EF%BC%8C%E8%BF%99%E6%98%AFonMeasure%E8%8E%B7%E5%8F%96%E5%88%B0%E7%9A%84%E5%B0%B1%E5%8F%AF%E8%83%BD%E4%B8%8D%E5%87%86%E7%A1%AE%EF%BC%8C%E6%89%80%E4%BB%A5%E5%8F%AF%E4%BB%A5%E5%9C%A8onLayout%E5%90%8E%E8%8E%B7%E5%8F%96%E6%B5%8B%E9%87%8F%E5%80%BC%0A%0A%23%23%20layout%0Alayout%E6%96%B9%E6%B3%95%E6%98%AF%E7%A1%AE%E5%AE%9Aviewgroup%E6%9C%AC%E8%BA%AB%E7%9A%84%E4%BD%8D%E7%BD%AE%EF%BC%8C%E8%80%8ConLayout%E6%96%B9%E6%B3%95%E6%98%AF%E7%A1%AE%E5%AE%9A%E6%89%80%E6%9C%89%E5%AD%90%E7%B1%BB%E7%9A%84%E4%BD%8D%E7%BD%AE%0Alayout%E6%96%B9%E6%B3%95%E9%A6%96%E5%85%88%E4%BC%9A%E8%B0%83%E7%94%A8setFram()%E7%A1%AE%E8%AE%A4%E8%87%AA%E5%B7%B1%E5%9B%9B%E4%B8%AA%E9%A1%B6%E7%82%B9%E7%9A%84%E4%BD%8D%E7%BD%AE%EF%BC%8C%E7%84%B6%E5%90%8E%E5%9C%A8%E8%B0%83%E7%94%A8onLayout()%0A%0A%E5%92%8Cmeasure%E4%B8%80%E6%A0%B7%EF%BC%8C%E4%B8%8D%E5%90%8C%E7%9A%84viewGroup%E6%9C%89%E4%B8%8D%E5%90%8C%E7%9A%84onLayout%E6%96%B9%E6%B3%95%0A%E5%A6%82linearlayout%EF%BC%8C%E5%AE%83%E4%BC%9A%E5%85%88%E9%81%8D%E5%8E%86view%E5%B9%B6%E8%8E%B7%E5%8F%96view%E5%88%B0specSize%EF%BC%8C%E5%B9%B6%E8%AE%A1%E7%AE%97%E5%87%BAview%E5%88%B0left%E5%92%8Ctop%EF%BC%8C%E4%B9%8B%E5%90%8E%E5%9C%A8%E8%B0%83%E7%94%A8setChildFrame()%E6%9D%A5%E8%B0%83%E7%94%A8%E5%AD%90%E7%B1%BB%E7%9A%84onLayout%E6%96%B9%E6%B3%95%E3%80%82%0A%0A%23%23%20draw%0Adraw%E4%BD%9C%E7%94%A8%E6%98%AF%E5%B0%86view%E7%BB%98%E5%88%B6%E5%9C%A8%E5%B1%8F%E5%B9%95%E4%B8%8A%0A%E4%BC%9A%E4%BE%9D%E6%AC%A1%E8%B0%83%E7%94%A8%EF%BC%9A%0AdrawBackground(canvas)%E7%BB%98%E5%88%B6%E8%83%8C%E6%99%AF%0AonDraw(canvas)%E7%BB%98%E5%88%B6%E8%87%AA%E8%BA%AB%0AdispatchDraw(canvas)%E7%BB%98%E5%88%B6%E5%AD%90%E7%B1%BB%EF%BC%8C%E5%AE%83%E4%BC%9A%E9%81%8D%E5%8E%86%E8%B0%83%E7%94%A8%E6%89%80%E6%9C%89%E5%AD%90%E7%B1%BB%E7%9A%84draw%0AonDrawSrollBars(canvas)%E7%BB%98%E5%88%B6%E8%A3%85%E6%9D%9F%EF%BC%9F%0A%0AsetWillNotDraw(boolean)%0A%E5%BD%93%E6%88%91%E4%BB%AC%E8%87%AA%E5%AE%9A%E4%B9%89view%E7%BB%A7%E6%89%BF%E4%BA%8Eviewgroup%E5%B9%B6%E4%B8%94%E4%B8%8D%E9%9C%80%E8%A6%81%E5%85%B7%E5%A4%87%E7%BB%98%E5%88%B6%E5%8A%9F%E8%83%BD%E6%97%B6%EF%BC%8C%E5%8F%AF%E4%BB%A5%E8%AE%BE%E7%BD%AE%E5%AE%83%E4%BB%A5%E4%BE%BF%E7%B3%BB%E7%BB%9F%E5%90%8E%E7%BB%AD%E4%BC%98%E5%8C%96</center></body></html>